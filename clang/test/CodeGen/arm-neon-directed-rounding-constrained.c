// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py UTC_ARGS: --version 5
// RUN: %clang_cc1 -triple thumbv8-linux-gnueabihf -target-cpu cortex-a57 \
// RUN:     -ffreestanding -disable-O0-optnone -emit-llvm %s -o - | \
// RUN:     opt -S -passes=mem2reg,instcombine | FileCheck -check-prefixes=UNCONSTRAINED-A32 %s
// RUN: %clang_cc1 -triple arm64-linux-gnueabihf -target-feature +neon \
// RUN:     -ffreestanding -disable-O0-optnone -emit-llvm %s -o - | \
// RUN:     opt -S -passes=mem2reg,instcombine | FileCheck -check-prefixes=UNCONSTRAINED-A64 %s

// RUN: %clang_cc1 -triple thumbv8-linux-gnueabihf -target-cpu cortex-a57 \
// RUN:     -ffp-exception-behavior=strict \
// RUN:     -fexperimental-strict-floating-point \
// RUN:     -ffreestanding -disable-O0-optnone -emit-llvm %s -o - | \
// RUN:     opt -S -passes=mem2reg,instcombine | FileCheck -check-prefixes=CONSTRAINED-A32 %s
// RUN: %clang_cc1 -triple arm64-linux-gnueabihf -target-feature +neon \
// RUN:     -ffp-exception-behavior=strict \
// RUN:     -ffreestanding -disable-O0-optnone -emit-llvm %s -o - | \
// RUN:     opt -S -passes=mem2reg,instcombine | FileCheck -check-prefixes=CONSTRAINED-A64 %s

// REQUIRES: arm-registered-target,aarch64-registered-target

#include <arm_neon.h>

// UNCONSTRAINED-A32-LABEL: define dso_local <2 x float> @test_vrndi_f32(
// UNCONSTRAINED-A32-SAME: <2 x float> noundef [[A:%.*]]) #[[ATTR0:[0-9]+]] {
// UNCONSTRAINED-A32-NEXT:  [[ENTRY:.*:]]
// UNCONSTRAINED-A32-NEXT:    [[VRNDI_V1_I:%.*]] = call <2 x float> @llvm.nearbyint.v2f32(<2 x float> [[A]])
// UNCONSTRAINED-A32-NEXT:    ret <2 x float> [[VRNDI_V1_I]]
//
// UNCONSTRAINED-A64-LABEL: define dso_local <2 x float> @test_vrndi_f32(
// UNCONSTRAINED-A64-SAME: <2 x float> noundef [[A:%.*]]) #[[ATTR0:[0-9]+]] {
// UNCONSTRAINED-A64-NEXT:  [[ENTRY:.*:]]
// UNCONSTRAINED-A64-NEXT:    [[VRNDI_V1_I:%.*]] = call <2 x float> @llvm.nearbyint.v2f32(<2 x float> [[A]])
// UNCONSTRAINED-A64-NEXT:    ret <2 x float> [[VRNDI_V1_I]]
//
// CONSTRAINED-A32-LABEL: define dso_local <2 x float> @test_vrndi_f32(
// CONSTRAINED-A32-SAME: <2 x float> noundef [[A:%.*]]) #[[ATTR0:[0-9]+]] {
// CONSTRAINED-A32-NEXT:  [[ENTRY:.*:]]
// CONSTRAINED-A32-NEXT:    [[VRNDI_V1_I:%.*]] = call <2 x float> @llvm.experimental.constrained.nearbyint.v2f32(<2 x float> [[A]], metadata !"round.tonearest", metadata !"fpexcept.strict") #[[ATTR2:[0-9]+]]
// CONSTRAINED-A32-NEXT:    ret <2 x float> [[VRNDI_V1_I]]
//
// CONSTRAINED-A64-LABEL: define dso_local <2 x float> @test_vrndi_f32(
// CONSTRAINED-A64-SAME: <2 x float> noundef [[A:%.*]]) #[[ATTR0:[0-9]+]] {
// CONSTRAINED-A64-NEXT:  [[ENTRY:.*:]]
// CONSTRAINED-A64-NEXT:    [[VRNDI_V1_I:%.*]] = call <2 x float> @llvm.experimental.constrained.nearbyint.v2f32(<2 x float> [[A]], metadata !"round.tonearest", metadata !"fpexcept.strict") #[[ATTR2:[0-9]+]]
// CONSTRAINED-A64-NEXT:    ret <2 x float> [[VRNDI_V1_I]]
//
float32x2_t test_vrndi_f32(float32x2_t a) {
  return vrndi_f32(a);
}

// UNCONSTRAINED-A32-LABEL: define dso_local <4 x float> @test_vrndiq_f32(
// UNCONSTRAINED-A32-SAME: <4 x float> noundef [[A:%.*]]) #[[ATTR0]] {
// UNCONSTRAINED-A32-NEXT:  [[ENTRY:.*:]]
// UNCONSTRAINED-A32-NEXT:    [[VRNDIQ_V1_I:%.*]] = call <4 x float> @llvm.nearbyint.v4f32(<4 x float> [[A]])
// UNCONSTRAINED-A32-NEXT:    ret <4 x float> [[VRNDIQ_V1_I]]
//
// UNCONSTRAINED-A64-LABEL: define dso_local <4 x float> @test_vrndiq_f32(
// UNCONSTRAINED-A64-SAME: <4 x float> noundef [[A:%.*]]) #[[ATTR0]] {
// UNCONSTRAINED-A64-NEXT:  [[ENTRY:.*:]]
// UNCONSTRAINED-A64-NEXT:    [[VRNDIQ_V1_I:%.*]] = call <4 x float> @llvm.nearbyint.v4f32(<4 x float> [[A]])
// UNCONSTRAINED-A64-NEXT:    ret <4 x float> [[VRNDIQ_V1_I]]
//
// CONSTRAINED-A32-LABEL: define dso_local <4 x float> @test_vrndiq_f32(
// CONSTRAINED-A32-SAME: <4 x float> noundef [[A:%.*]]) #[[ATTR0]] {
// CONSTRAINED-A32-NEXT:  [[ENTRY:.*:]]
// CONSTRAINED-A32-NEXT:    [[VRNDIQ_V1_I:%.*]] = call <4 x float> @llvm.experimental.constrained.nearbyint.v4f32(<4 x float> [[A]], metadata !"round.tonearest", metadata !"fpexcept.strict") #[[ATTR2]]
// CONSTRAINED-A32-NEXT:    ret <4 x float> [[VRNDIQ_V1_I]]
//
// CONSTRAINED-A64-LABEL: define dso_local <4 x float> @test_vrndiq_f32(
// CONSTRAINED-A64-SAME: <4 x float> noundef [[A:%.*]]) #[[ATTR0]] {
// CONSTRAINED-A64-NEXT:  [[ENTRY:.*:]]
// CONSTRAINED-A64-NEXT:    [[VRNDIQ_V1_I:%.*]] = call <4 x float> @llvm.experimental.constrained.nearbyint.v4f32(<4 x float> [[A]], metadata !"round.tonearest", metadata !"fpexcept.strict") #[[ATTR2]]
// CONSTRAINED-A64-NEXT:    ret <4 x float> [[VRNDIQ_V1_I]]
//
float32x4_t test_vrndiq_f32(float32x4_t a) {
  return vrndiq_f32(a);
}
