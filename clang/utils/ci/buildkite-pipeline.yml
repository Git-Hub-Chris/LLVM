#===----------------------------------------------------------------------===##
#
# Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.
# See https://llvm.org/LICENSE.txt for license information.
# SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
#
#===----------------------------------------------------------------------===##

#
# This file describes the various pre-commit CI bots used to test Clang against
# libc++ under various configurations. Unlike the usual libc++ CI pipeline,
# which aims to test libc++ itself, this pipeline aims to test Clang by
# compiling libc++ and running its test suite against the just-built Clang,
# in various configurations.
#
env:
    # LLVM RELEASE bump version
    LLVM_HEAD_VERSION: "17"
steps:
  - label: "Building and testing clang (Windows)"
    commands:
      - "C:\\BuildTools\\Common7\\Tools\\VsDevCmd.bat -arch=amd64 -host_arch=amd64"
      - "bash clang/utils/ci/run-buildbot build-clang-windows"
    agents:
      queue: "windows-test"
    retry:
      automatic:
        - exit_status: -1  # Agent was lost
          limit: 2
    timeout_in_minutes: 120
