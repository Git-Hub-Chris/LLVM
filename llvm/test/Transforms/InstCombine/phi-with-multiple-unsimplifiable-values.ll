; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 5
; RUN: opt < %s -passes=instcombine -S | FileCheck %s

define i1 @icmp_of_phi_of_scmp_with_constant(i1 %c, i16 %x, i16 %y)
; CHECK-LABEL: define i1 @icmp_of_phi_of_scmp_with_constant(
; CHECK-SAME: i1 [[C:%.*]], i16 [[X:%.*]], i16 [[Y:%.*]]) {
; CHECK-NEXT:  [[ENTRY:.*:]]
; CHECK-NEXT:    br i1 [[C]], label %[[TRUE:.*]], label %[[FALSE:.*]]
; CHECK:       [[TRUE]]:
; CHECK-NEXT:    [[CMP1:%.*]] = call i8 @llvm.scmp.i8.i16(i16 [[X]], i16 [[Y]])
; CHECK-NEXT:    br label %[[EXIT:.*]]
; CHECK:       [[FALSE]]:
; CHECK-NEXT:    [[CMP2:%.*]] = call i8 @llvm.scmp.i8.i16(i16 [[Y]], i16 [[X]])
; CHECK-NEXT:    br label %[[EXIT]]
; CHECK:       [[EXIT]]:
; CHECK-NEXT:    [[PHI:%.*]] = phi i8 [ [[CMP1]], %[[TRUE]] ], [ [[CMP2]], %[[FALSE]] ]
; CHECK-NEXT:    [[R:%.*]] = icmp slt i8 [[PHI]], 0
; CHECK-NEXT:    ret i1 [[R]]
;
{
entry:
  br i1 %c, label %true, label %false
true:
  %cmp1 = call i8 @llvm.scmp(i16 %x, i16 %y)
  br label %exit
false:
  %cmp2 = call i8 @llvm.scmp(i16 %y, i16 %x)
  br label %exit
exit:
  %phi = phi i8 [%cmp1, %true], [%cmp2, %false]
  %r = icmp slt i8 %phi, 0
  ret i1 %r
}
