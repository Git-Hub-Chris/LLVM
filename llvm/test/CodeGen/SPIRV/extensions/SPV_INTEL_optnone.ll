; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --skip-check-label --version 3
; RUN: llc -O0 -mtriple=spirv32-unknown-unknown --spirv-extensions=SPV_INTEL_optnone %s -o - | FileCheck %s --check-prefix=CHECK-EXTENSION
; RUN: llc -O0 -mtriple=spirv32-unknown-unknown %s -o - | FileCheck %s --check-prefix=CHECK-NO-EXTENSION

; CHECK-EXTENSION: OpCapability OptNoneINTEL
; CHECK-EXTENSION: OpExtension "SPV_INTEL_optnone"
; CHECK-NO-EXTENSION-NOT: OpCapability OptNoneINTEL
; CHECK-NO-EXTENSION-NOT: OpExtension "SPV_INTEL_optnone"

;; Per SPIR-V spec:
;; FunctionControlDontInlineMask = 0x2 (2)
; CHECK-EXTENSION: %[[#]] = OpFunction %[[#]] DontInline

; Function Attrs: nounwind optnone noinline
define spir_func void @_Z3foov() #0 {
; CHECK-EXTENSION:         %4 = OpFunction %2 DontInline %3
; CHECK-EXTENSION-NEXT:    %5 = OpLabel
; CHECK-EXTENSION-NEXT:    OpReturn
; CHECK-EXTENSION-NEXT:    OpFunctionEnd
;
; CHECK-NO-EXTENSION:         %4 = OpFunction %2 DontInline %3
; CHECK-NO-EXTENSION-NEXT:    %5 = OpLabel
; CHECK-NO-EXTENSION-NEXT:    OpReturn
; CHECK-NO-EXTENSION-NEXT:    OpFunctionEnd
entry:
  ret void
}

attributes #0 = { nounwind optnone noinline }
