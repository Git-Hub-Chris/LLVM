if not "PowerPC" in config.root.targets:
    config.unsupported = True

import subprocess

config.suffixes.add(".py")

def get_revision(repo_path):
  cmd = ['git', '-C', repo_path, 'rev-parse', 'HEAD']
  return subprocess.run(cmd, stdout=subprocess.PIPE).stdout.decode('ascii')

if config.have_vc_rev:
  config.available_features.add("vc-rev-enabled")
  if config.force_vc_rev:
    git_revision = config.force_vc_rev
  else:
    git_revision = get_revision(config.llvm_src_root)
  config.substitutions.append(("git-revision", git_revision))
