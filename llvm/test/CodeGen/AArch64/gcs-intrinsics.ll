; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc -mtriple=aarch64 -mattr=+gcs -verify-machineinstrs -o - %s | FileCheck %s

define i64 @test_chkfeat(i64 %arg) {
; CHECK-LABEL: test_chkfeat:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    mov x16, x0
; CHECK-NEXT:    chkfeat x16
; CHECK-NEXT:    mov x0, x16
; CHECK-NEXT:    ret
entry:
  %0 = call i64 @llvm.aarch64.chkfeat(i64 %arg)
  ret i64 %0
}

define i64 @test_gcspopm(i64 %arg) {
; CHECK-LABEL: test_gcspopm:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    gcspopm x0
; CHECK-NEXT:    ret
entry:
  %0 = call i64 @llvm.aarch64.gcspopm(i64 %arg)
  ret i64 %0
}

define void @test_gcsss1(ptr %p) {
; CHECK-LABEL: test_gcsss1:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    gcsss1 x0
; CHECK-NEXT:    ret
entry:
  call void @llvm.aarch64.gcsss1(ptr %p)
  ret void
}

define ptr @test_gcsss2(ptr %p) {
; CHECK-LABEL: test_gcsss2:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    gcsss2 x0
; CHECK-NEXT:    ret
entry:
  %0 = call ptr @llvm.aarch64.gcsss2(ptr %p)
  ret ptr %0
}

declare i64 @llvm.aarch64.chkfeat(i64)
declare i64 @llvm.aarch64.gcspopm(i64)
declare void @llvm.aarch64.gcsss1(ptr)
declare ptr @llvm.aarch64.gcsss2(ptr)
