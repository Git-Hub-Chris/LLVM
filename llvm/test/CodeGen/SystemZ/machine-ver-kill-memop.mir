# RUN: llc -o /dev/null %s -mtriple=s390x-linux-gnu -mcpu=z16 \
# RUN:   -verify-machineinstrs -run-pass=register-coalescer

# Test that the MemoryOperand of the produced KILL instruction is removed
# and as a result the machine verifier succeeds.

--- |
  define void @fun(ptr %Src, ptr %Dst, ptr %Src2) {
    ret void
  }
...
---
name:            fun
alignment:       16
tracksRegLiveness: true
noPhis:          true
isSSA:           false
noVRegs:         false
hasFakeUses:     false
registers:
  - { id: 0, class: grx32bit }
  - { id: 1, class: grx32bit }
  - { id: 2, class: grx32bit }
  - { id: 3, class: addr64bit }
  - { id: 4, class: gr64bit }
  - { id: 5, class: grx32bit }
  - { id: 6, class: grx32bit }
  - { id: 7, class: grx32bit }
  - { id: 8, class: addr64bit }
liveins:
  - { reg: '$r2d', virtual-reg: '%3' }
frameInfo:
  maxAlignment:    1
machineFunctionInfo: {}
body:             |
  bb.0:
    liveins: $r2d
  
    %3:addr64bit = COPY killed $r2d
  
  bb.1:
    %5:grx32bit = LMux killed %3, 0, $noreg :: (load (s32) from %ir.Src)
    CHIMux killed %5, 0, implicit-def $cc
    %7:grx32bit = LHIMux 0
    %1:grx32bit = COPY killed %7
    %1:grx32bit = LOCMux %1, undef %8:addr64bit, 0, 14, 6, implicit killed $cc :: (load (s32) from %ir.Src2)
    dead %0:grx32bit = COPY killed %1
  
  bb.2:
    J %bb.2

...
