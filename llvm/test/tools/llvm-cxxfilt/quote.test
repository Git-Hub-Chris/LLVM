// Show that llvm-cxxfilt --quote can emit quoted demangled symbols (even at the
// end of a line) but not without double-quoting in the case they are already
// quoted.
RUN: echo _Z3barv '"_Z3barv"' > %t
RUN: echo '"_Z3barv"' _Z3barv >> %t
// This is not mangled, thus it should not be quoted
RUN: echo 'log()' >> %t
RUN: llvm-cxxfilt --quote < %t | FileCheck --match-full-lines --check-prefix=CHECK-FILE %s
CHECK-FILE: "bar()" "bar()"
CHECK-FILE-NEXT: "bar()" "bar()"
CHECK-FILE-NEXT: log()

// Check it works with cli symbols too. Since a quoted mangled name is not a
// mangled name, it should be unchanged
RUN: llvm-cxxfilt --quote _Z3firv '"_Z3barv"' 'saw()' | FileCheck --match-full-lines --check-prefix=CHECK-CLI %s
CHECK-CLI: "fir()"
CHECK-CLI: "_Z3barv"
CHECK-CLI: saw()
