# RUN: yaml2obj %s | od -v -An -tx1 | FileCheck --ignore-case %s

--- !GOFF
FileHeader:
  CharacterSetName: 'IBM-1047'
  ArchitectureLevel: 1
Records:
# CHECK: 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 01 a7 00 00 00 00 00 00 00
  - Symbol:
      Name:              'x'
      Type:              ESD_ST_SectionDefinition
      ID:                1
      NameSpace:         ESD_NS_NormalName
# CHECK: 03 00 00 01 00 00 00 02 00 00 00 01 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 03 81 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 04 04 01 01
# CHECK: 00 40 03 00 00 00 00 07 c3 6d e6 e2 c1 f6 f4 00
  - Symbol:
      Name:              'C_WSA64'
      Type:              ESD_ST_ElementDefinition
      ID:                2
      OwnerID:           1
      NameSpace:         ESD_NS_Parts
      Flags:             [ ESD_FillByteValuePresent, ESD_RQ_1 ]
      FillByteValue:     0
      Amode:             ESD_AMODE_64
      Rmode:             ESD_RMODE_64
      BindingAlgorithm:  ESD_BA_Merge
      Executable:        ESD_EXE_DATA
      LoadingBehavior:   ESD_LB_Deferred
      Alignment:         ESD_ALIGN_Doubleword
# CHECK: 03 00 00 03 00 00 00 03 00 00 00 02 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 03 20 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 04 00 00 01
# CHECK: 00 20 00 00 00 00 00 01 a7 00 00 00 00 00 00 00
  - Symbol:
      Name:              'x'
      Type:              ESD_ST_PartReference
      ID:                3
      OwnerID:           2
      Length:            4
      NameSpace:         ESD_NS_Parts
      Flags:             [ ESD_SymbolRenamingFlag ]
      Amode:             ESD_AMODE_64
      Executable:        ESD_EXE_DATA
      BAFlags:           [ ESD_BA_COMMON ]
# A TXT Record. Byte 1, bits 0-3 should be 0001.
# CHECK: 03 10 00 00 00 00 00 03 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  - Section:
      SymbolName:        'x'
      SymbolID:          3
      DataLength:        8
# Record with a Relocation Dictionary is indicated by byte 1,
# bits 0-3 should be 0010.
# We have four data items. The first is missing the extended
# attribute fields/offset so it has a length of 20 bytes.
# The second has the RLD_Same_Offset flag so the offset field
# isn't present, meaning it is 16 bytes. The third has the
# RLD_SAME_PID flag in addition, and the fourth has the
# RLD_SAME_RID flag in addition to the flags on the third
# data item so they are 12 and 8 bytes respectively, so
# the expected length of data items are 20+16+12+8 = 0x38.
# CHECK: 03 20 00 00 00 38 00 71 02 00 01 44 00 00 00 00
# CHECK: 00 03 00 00 00 03 00 00 00 05 20 71 02 00 01 44
# CHECK: 00 00 00 00 00 03 00 00 00 03 60 71 02 00 01 44
# CHECK: 00 00 00 00 00 03 e0 71 02 00 01 44 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  - Relocations:
      - Flags:           []
        ReferenceType:   RLD_RT_RTypeConstant
        ReferentType:    RLD_RO_Element
        Action:          RLD_ACT_Subtract
        TargetFieldByteLength: 1
        BitLength:       4
        BitOffset:       4
        RPointer:        3
        PPointer:        3
        Offset:          5
      - Flags:           [RLD_Same_Offset]
        ReferenceType:   RLD_RT_RTypeConstant
        ReferentType:    RLD_RO_Element
        Action:          RLD_ACT_Subtract
        TargetFieldByteLength: 1
        BitLength:       4
        BitOffset:       4
        RPointer:        3
        PPointer:        3
      - Flags:           [RLD_Same_Offset,RLD_Same_PID]
        ReferenceType:   RLD_RT_RTypeConstant
        ReferentType:    RLD_RO_Element
        Action:          RLD_ACT_Subtract
        TargetFieldByteLength: 1
        BitLength:       4
        BitOffset:       4
        RPointer:        3
      - Flags:           [RLD_Same_Offset,RLD_Same_PID,RLD_Same_RID]
        ReferenceType:   RLD_RT_RTypeConstant
        ReferentType:    RLD_RO_Element
        Action:          RLD_ACT_Subtract
        TargetFieldByteLength: 1
        BitLength:       4
        BitOffset:       4
# Relocation Dictionary with two data items. First data item has
# extended attributes so it has the maximal data size of 28 bytes.
# Second data item has different RID, PID, and offset as previous item
# so it has data size of 20, so expected data size is 28 + 20 + 48 = 0x30.
# CHECK: 03 20 00 00 00 30 04 71 02 00 01 44 00 00 00 00
# CHECK: 00 03 00 00 00 03 00 00 00 0a 00 00 00 01 00 00
# CHECK: 00 06 00 71 02 00 01 44 00 00 00 00 00 02 00 00
# CHECK: 00 02 00 00 00 05 00 00 00 00 00 00 00 00 00 00
# CHECK: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  - Relocations:
      - Flags:           [RLD_EA_Present]
        ReferenceType:   RLD_RT_RTypeConstant
        ReferentType:    RLD_RO_Element
        Action:          RLD_ACT_Subtract
        TargetFieldByteLength: 1
        BitLength:       4
        BitOffset:       4
        RPointer:        3
        PPointer:        3
        Offset:          10
        ExtAttrID:       1
        ExtAttrOffset:   6
      - Flags:           []
        ReferenceType:   RLD_RT_RTypeConstant
        ReferentType:    RLD_RO_Element
        Action:          RLD_ACT_Subtract
        TargetFieldByteLength: 1
        BitLength:       4
        BitOffset:       4
        RPointer:        2
        PPointer:        2
        Offset:          5
...
